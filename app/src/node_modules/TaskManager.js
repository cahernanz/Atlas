/**
 * @author : Mario Juez (mario@mjuez.com)
 *
 * @license: GPL v3
 *     This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

'use strict';

const Task = require('Task');
const Observable = require('Observable');
let instance = null;

/**
 * TaskManager.js (Singleton)
 */
class TaskManager extends Observable {

    constructor() {
        if (!instance) {
            super();
            this.numTasks = 0;
            this.nextId = 0;
            this.tasks = {};
            instance = this;
        }
        return instance;
    }

    addTask(task) {
        if (task instanceof Task) {
            this.tasks[this.nextId] = task;
            task.setId(this.nextId);
            this.numTasks += 1;
            this.nextId += 1;
            this.fire("change");
            return true;
        }
        return false;
    }

    removeTask(id) {
        delete this.tasks[id];
        this.numTasks -= 1;
        this.fire("change");
    }

}

module.exports = new TaskManager();